(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"99Un":function(e,t,n){"use strict";n.r(t);var i=n("ofXK"),o=n("tyNb"),s=n("5+WD"),r=n("xgIS"),c=n("XNiG"),d=n("1G5W"),a=n("gcYM"),l=n("kl1M"),u=n("fXoL"),b=n("PScX"),h=n("Nqz0"),p=n("5jdD"),m=n("XNvx"),g=n("lL+R"),f=n("tk/3"),v=n("3iI7");let z=(()=>{class e{constructor(e,t){this.http=e,this.url=t,this.transTreeDragEnd=new c.a}addFile(e){const t=this.url.getUrl(g.a.addMenu);return this.http.post(t,e)}editFile(e){const t=this.url.getUrl(g.a.updateMenu);return this.http.post(t,e)}delFile(e){const t=this.url.getUrl(g.a.delMenu);return this.http.post(t,{mid:e})}updateMenuSort(e){const t=this.url.getUrl(g.a.updateMenuSort);return this.http.post(t,e)}moveItem(e){const t=this.url.getUrl(g.a.moveItem);return this.http.post(t,e)}}return e.\u0275fac=function(t){return new(t||e)(u.dc(f.c),u.dc(v.a))},e.\u0275prov=u.Pb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var x=n("yW9e"),k=n("OzZK"),I=n("C2AL"),w=n("RwU8"),y=n("FwiY"),M=n("Q8cG"),S=n("ifs9"),C=n("LRne"),D=n("yCtX"),N=n("DH7j"),O=n("7o/Q"),L=n("l7GE"),Z=n("ZUHj"),Y=n("Lhse");class T{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new _(e,this.resultSelector))}}class _ extends O.a{constructor(e,t,n=Object.create(null)){super(e),this.iterators=[],this.active=0,this.resultSelector="function"==typeof t?t:null,this.values=n}_next(e){const t=this.iterators;Object(N.a)(e)?t.push(new P(e)):t.push("function"==typeof e[Y.a]?new E(e[Y.a]()):new F(this.destination,this,e))}_complete(){const e=this.iterators,t=e.length;if(this.unsubscribe(),0!==t){this.active=t;for(let n=0;n<t;n++){let t=e[n];t.stillUnsubscribed?this.destination.add(t.subscribe(t,n)):this.active--}}else this.destination.complete()}notifyInactive(){this.active--,0===this.active&&this.destination.complete()}checkIterators(){const e=this.iterators,t=e.length,n=this.destination;for(let s=0;s<t;s++){let t=e[s];if("function"==typeof t.hasValue&&!t.hasValue())return}let i=!1;const o=[];for(let s=0;s<t;s++){let t=e[s],r=t.next();if(t.hasCompleted()&&(i=!0),r.done)return void n.complete();o.push(r.value)}this.resultSelector?this._tryresultSelector(o):n.next(o),i&&n.complete()}_tryresultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}class E{constructor(e){this.iterator=e,this.nextResult=e.next()}hasValue(){return!0}next(){const e=this.nextResult;return this.nextResult=this.iterator.next(),e}hasCompleted(){const e=this.nextResult;return e&&e.done}}class P{constructor(e){this.array=e,this.index=0,this.length=0,this.length=e.length}[Y.a](){return this}next(e){const t=this.index++;return t<this.length?{value:this.array[t],done:!1}:{value:null,done:!0}}hasValue(){return this.array.length>this.index}hasCompleted(){return this.array.length===this.index}}class F extends L.a{constructor(e,t,n){super(e),this.parent=t,this.observable=n,this.stillUnsubscribed=!0,this.buffer=[],this.isComplete=!1}[Y.a](){return this}next(){const e=this.buffer;return 0===e.length&&this.isComplete?{value:null,done:!0}:{value:e.shift(),done:!1}}hasValue(){return this.buffer.length>0}hasCompleted(){return 0===this.buffer.length&&this.isComplete}notifyComplete(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()}notifyNext(e,t,n,i,o){this.buffer.push(t),this.parent.checkIterators()}subscribe(e,t){return Object(Z.a)(this,this.observable,this,t)}}var j=n("eIep"),U=n("pLZG"),$=n("IzEk");class V{constructor(){this.drag_file="true",this.is_catalog=3}}var R=n("qAZ0"),A=n("nxWG"),G=n("dEAy"),J=n("3Pt+"),Q=n("B+r4"),K=n("ocnv"),q=n("PTRe"),H=n("QlLE"),W=n("nJia");const X=["treeDiv"],B=["nzTree"];function ee(e,t){1&e&&u.Ub(0,"nz-empty",14),2&e&&u.sc("nzNotFoundContent","\u6682\u65e0\u6570\u636e")}function te(e,t){if(1&e){const e=u.ac();u.Zb(0,"li",17),u.hc("click",(function(){u.Cc(e);const t=u.kc().$implicit;return u.kc().paste(t)})),u.Lc(1," \u7c98\u8d34 "),u.Yb()}}function ne(e,t){if(1&e){const e=u.ac();u.Zb(0,"div",32),u.hc("contextmenu",(function(t){u.Cc(e),u.kc();const n=u.Ac(1);return u.kc().contextMenu(t,n)})),u.Zb(1,"i",33),u.hc("click",(function(){u.Cc(e);const t=u.kc().$implicit;return u.kc().openFolder(t)})),u.Yb(),u.Zb(2,"span",34),u.Lc(3),u.Yb(),u.Yb()}if(2&e){const e=u.kc().$implicit;u.sc("nzTooltipTitle",e.title),u.Db(1),u.sc("nzType",e.isExpanded?"folder-open":"folder"),u.Db(2),u.Mc(e.title)}}function ie(e,t){if(1&e){const e=u.ac();u.Zb(0,"span",35),u.hc("contextmenu",(function(t){u.Cc(e),u.kc();const n=u.Ac(1);return u.kc().contextMenu(t,n)})),u.Ub(1,"i",36),u.Zb(2,"span",37),u.Lc(3),u.Yb(),u.Yb()}if(2&e){const e=u.kc().$implicit;u.Db(3),u.Mc(e.title)}}function oe(e,t){if(1&e){const e=u.ac();u.Zb(0,"nz-dropdown-menu",null,15),u.Zb(2,"ul",16),u.Zb(3,"li",17),u.hc("click",(function(){u.Cc(e);const n=t.$implicit;return u.kc().cut(n)})),u.Lc(4,"\u526a\u5207"),u.Yb(),u.Jc(5,te,2,0,"li",18),u.Yb(),u.Yb(),u.Zb(6,"div",19),u.Zb(7,"div",20),u.Zb(8,"span",21),u.Jc(9,ne,4,3,"div",22),u.Jc(10,ie,4,1,"span",23),u.Yb(),u.Zb(11,"a",24),u.Zb(12,"strong"),u.Ub(13,"i",25),u.Yb(),u.Yb(),u.Zb(14,"nz-dropdown-menu",null,26),u.Zb(16,"ul",16),u.Zb(17,"li",27),u.Zb(18,"a",28),u.hc("click",(function(n){u.Cc(e);const i=t.$implicit;return u.kc().add(n,i.key)})),u.Ub(19,"i",2),u.Yb(),u.Yb(),u.Zb(20,"li",27),u.Zb(21,"a",28),u.hc("click",(function(n){u.Cc(e);const i=t.$implicit;return u.kc().startEdit(n,i)})),u.Ub(22,"i",29),u.Yb(),u.Yb(),u.Zb(23,"li",27),u.Zb(24,"a",28),u.hc("click",(function(n){u.Cc(e);const i=t.$implicit;return u.kc().deleteNode(n,i.key)})),u.Ub(25,"i",30),u.Yb(),u.Yb(),u.Yb(),u.Yb(),u.Yb(),u.Zb(26,"input",31),u.hc("ngModelChange",(function(n){return u.Cc(e),t.$implicit.title=n}))("click",(function(t){return u.Cc(e),u.kc().inputClick(t)}))("blur",(function(){u.Cc(e);const n=t.$implicit;return u.kc().stopEdit(n)})),u.Yb(),u.Yb()}if(2&e){const e=t.$implicit,n=u.Ac(15),i=u.kc();u.Db(5),u.sc("ngIf",i.moveItem&&i.moveItem.mid!=e.origin.id),u.Db(1),u.sc("id",e.key),u.Db(1),u.sc("hidden",i.editId===e.key),u.Db(2),u.sc("ngIf",!e.isLeaf),u.Db(1),u.sc("ngIf",e.isLeaf),u.Db(1),u.sc("nzDropdownMenu",n),u.Db(15),u.sc("hidden",i.editId!==e.key)("ngModel",e.title)}}let se=(()=>{class e{constructor(e,t,n,i,o,s){this.nzContextMenuService=e,this.msgService=t,this.el=n,this.noteService=i,this.note2Service=o,this.render2=s,this.menuList=new u.n,this.nodeList=new u.n,this.clearList=new u.n,this.activatedNodeEmit=new u.n,this.destroy$=new c.a,this.isSpinning=!1,this.pid=0,this.nodes=[],this.moveItem=new V,this.Visible=!1,this.isOkLoading=!1,this.addFileItem={name:"",pid:this.pid}}openFolder(e){if(e instanceof S.d)e.isExpanded=!e.isExpanded;else{const t=e.node;t&&(t.isExpanded=!t.isExpanded)}}activeNode(e){this.activatedNode=e.node,this.activatedNodeEmit.emit(this.activatedNode.key)}contextMenu(e,t){this.nzContextMenuService.create(e,t)}selectDropdown(){}ngOnInit(){}nzEvent(e){const t=e.dragNode;t.parentNode?t.level===e.node.level&&this.dragNodeLevel===t.level&&this.dragNodeParentId===t.parentNode.origin.id?this.updateMenuSort(t.parentNode):(this.moveItem.mid=t.parentNode.origin.id,this.moveItem.itemid=t.origin.id,this.dragMoveItem(t.parentNode)):this.updateFootMenuSort(e)}dragEnd(e){console.log(e)}startEdit(e,t){e.stopPropagation(),this.editId=t.key,this.editName=t.title}inputClick(e){e.stopPropagation()}stopEdit(e){this.editId=null,this.editName!==e.title&&(this.editName=null,this.editFile(e))}showModal(){this.Visible=!0}handleOk(){this.isOkLoading=!0,this.note2Service.addFile(this.addFileItem).subscribe(e=>{this.Visible=!1,this.isOkLoading=!1,this.menuList.emit()})}handleCancel(){this.Visible=!1}editFile(e){this.note2Service.editFile({mid:e.key,name:e.title}).subscribe(e=>{this.menuList.emit()})}add(e,t){e.stopPropagation(),this.addFileItem.pid=this.pid=t,this.addFile()}addFile(){this.showModal()}addFootFile(){this.addFileItem.pid=0,this.showModal()}deleteNode(e,t){e.stopPropagation(),this.note2Service.delFile(t).subscribe(e=>{this.menuList.emit(t),this.msgService.success("\u6e05\u9664\u6210\u529f")},e=>{this.msgService.warning("\u6e05\u9664\u5931\u8d25")})}dragMoveItem(e){this.note2Service.moveItem(this.moveItem).subscribe(t=>{e.children.length>1&&this.updateMenuSort(e)})}updateFootMenuSort(e){const t=e.dragNode;t.level===e.node.level&&this.dragNodeLevel===t.level&&this.dragNodeParentId===(t.parentNode?t.parentNode.origin.id:0)?this.updateRootMenuSort():(this.moveItem.mid=0,this.setMenuItem(),this.moveItem.itemid=t.origin.id,this.dragMoveRootItem())}updateRootMenuSort(){const e=this.nzTree.getTreeNodes().map(e=>e.origin.id);this.note2Service.updateMenuSort({pid:0,mid_arr:e}).subscribe(e=>{console.log(e),this.menuList.emit()})}dragMoveRootItem(){const e=this.nzTree.getTreeNodes();this.note2Service.moveItem(this.moveItem).subscribe(t=>{e.length>1&&this.updateMenuRootSort(e)})}updateMenuRootSort(e){const t=e.map(e=>e.origin.id);this.note2Service.updateMenuSort({pid:0,mid_arr:t}).subscribe(e=>{console.log(e),this.menuList.emit()})}updateMenuSort(e){const t=e.children.map(e=>e.origin.id);this.note2Service.updateMenuSort({pid:e.origin.id,mid_arr:t}).subscribe(e=>{console.log(e),this.menuList.emit()})}beforeDrop(e){return this.dragNodeLevel=e.dragNode.level,this.dragNodeParentId=e.dragNode.parentNode?e.dragNode.parentNode.origin.id:0,Object(C.a)(!0)}copy(e){this.activeItemId=e.origin.id,this.setMenuItem()}cut(e){this.activeItemId=e.origin.id,this.setMenuItem()}setMenuItem(){this.moveItem.drag_file="true",this.moveItem.is_catalog=3}paste(e){this.targetItem=e,this.moveItem.mid=e.origin.id,this.moveItem.itemid=this.activeItemId,this.note2Service.moveItem(this.moveItem).subscribe(e=>{2===this.moveItem.is_catalog?this.nodeList.emit():3===this.moveItem.is_catalog&&this.menuList.emit()})}ngAfterViewInit(){const e=this.treeDiv.nativeElement;this.noteService.dragSubject.pipe(Object(j.a)(t=>function(...e){const t=e[e.length-1];return"function"==typeof t&&e.pop(),Object(D.a)(e,void 0).lift(new T(t))}(Object(C.a)(t),Object(r.a)(e,"mouseup").pipe(Object(U.a)(e=>this.el.nativeElement.querySelector(".ant-tree .ant-tree-node-content-wrapper:hover")))).pipe(Object($.a)(1))),Object(d.a)(this.destroy$)).subscribe(e=>{const t=this.el.nativeElement.querySelector(".ant-tree .ant-tree-node-content-wrapper:hover").children[0].id;this.note2Service.transTreeDragEnd.next({delKey:e[0],addKey:t})})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(t){return new(t||e)(u.Tb(h.a),u.Tb(b.e),u.Tb(u.l),u.Tb(p.a),u.Tb(z),u.Tb(u.E))},e.\u0275cmp=u.Nb({type:e,selectors:[["app-note2"]],viewQuery:function(e,t){var n;1&e&&(u.Hc(X,!0),u.Hc(B,!0)),2&e&&(u.zc(n=u.ic())&&(t.treeDiv=n.first),u.zc(n=u.ic())&&(t.nzTree=n.first))},outputs:{menuList:"menuList",nodeList:"nodeList",clearList:"clearList",activatedNodeEmit:"activatedNodeEmit"},decls:19,vars:12,consts:[["treeDiv",""],["nz-button","","nzType","dashed",2,"margin","12px 0",3,"nzSize","click"],["nz-icon","","nzType","file-add","nzTheme","outline"],[2,"height","100%",3,"nzSpinning"],["style","margin-top: 48px;",3,"nzNotFoundContent",4,"ngIf"],["nzBlockNode","","nzDraggable","",3,"nzData","nzBeforeDrop","nzTreeTemplate","nzClick","nzDblClick","nzOnDrop","nzOnDragEnd"],["nzTree",""],["nzTreeTemplate",""],["nzTitle","\u65b0\u589e\u6587\u4ef6\u5939",3,"nzVisible","nzOkDisabled","nzOkLoading","nzVisibleChange","nzOnCancel","nzOnOk"],[1,"example-form"],["Form","ngForm"],[3,"nzSpan"],["nzHasFeedback","","nzErrorTip","\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a",3,"nzSpan"],["nz-input","","name","required","required","",3,"ngModel","ngModelChange"],[2,"margin-top","48px",3,"nzNotFoundContent"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",1,"dropdownMenu",3,"click"],["nz-menu-item","","class","dropdownMenu",3,"click",4,"ngIf"],[3,"id"],[2,"display","flex","justify-content","space-between","align-items","center",3,"hidden"],[1,"custom-node",2,"flex-grow","1"],["nz-tooltip","","style","display: flex; align-items: center;",3,"nzTooltipTitle","contextmenu",4,"ngIf"],["class","custom-node-icon",3,"contextmenu",4,"ngIf"],["nz-dropdown","","nz-button","","nzType","link","nzGhost","",1,"custom-node-icon",3,"nzDropdownMenu"],["nz-icon","","nzType","ellipsis","nzTheme","outline"],["nodeAction","nzDropdownMenu"],["nz-menu-item",""],["nz-button","","nzType","link","nzGhost","",1,"custom-node-icon",3,"click"],["nz-icon","","nzType","edit","nzTheme","outline"],["nz-icon","","nzType","delete","nzTheme","outline"],["type","text","nz-input","",3,"hidden","ngModel","ngModelChange","click","blur"],["nz-tooltip","",2,"display","flex","align-items","center",3,"nzTooltipTitle","contextmenu"],["nz-icon","",2,"width","20px",3,"nzType","click"],[1,"folder-name",2,"flex-grow","1","overflow","hidden","white-space","nowrap","text-overflow","ellipsis","width","20px"],[1,"custom-node-icon",3,"contextmenu"],["nz-icon","","nzType","file"],[1,"file-name"]],template:function(e,t){if(1&e&&(u.Zb(0,"div",null,0),u.Zb(2,"button",1),u.hc("click",(function(){return t.addFootFile()})),u.Ub(3,"i",2),u.Lc(4," \u65b0\u5efa\u6587\u4ef6\u5939 "),u.Yb(),u.Zb(5,"nz-spin",3),u.Jc(6,ee,1,1,"nz-empty",4),u.Zb(7,"nz-tree",5,6),u.hc("nzClick",(function(e){return t.activeNode(e)}))("nzDblClick",(function(e){return t.openFolder(e)}))("nzOnDrop",(function(e){return t.nzEvent(e)}))("nzOnDragEnd",(function(e){return t.dragEnd(e)})),u.Yb(),u.Jc(9,oe,27,8,"ng-template",null,7,u.Kc),u.Yb(),u.Yb(),u.Zb(11,"nz-modal",8),u.hc("nzVisibleChange",(function(e){return t.Visible=e}))("nzOnCancel",(function(){return t.handleCancel()}))("nzOnOk",(function(){return t.handleOk()})),u.Zb(12,"form",9,10),u.Zb(14,"nz-form-item"),u.Zb(15,"nz-form-label",11),u.Lc(16,"\u540d\u79f0"),u.Yb(),u.Zb(17,"nz-form-control",12),u.Zb(18,"input",13),u.hc("ngModelChange",(function(e){return t.addFileItem.name=e})),u.Yb(),u.Yb(),u.Yb(),u.Yb(),u.Yb()),2&e){const e=u.Ac(10),n=u.Ac(13);u.Db(2),u.sc("nzSize","small"),u.Db(3),u.sc("nzSpinning",t.isSpinning),u.Db(1),u.sc("ngIf",!t.nodes.length),u.Db(1),u.sc("nzData",t.nodes)("nzBeforeDrop",t.beforeDrop.bind(t))("nzTreeTemplate",e),u.Db(4),u.sc("nzVisible",t.Visible)("nzOkDisabled",!n.form.valid)("nzOkLoading",t.isOkLoading),u.Db(4),u.sc("nzSpan",5),u.Db(2),u.sc("nzSpan",12),u.Db(1),u.sc("ngModel",t.addFileItem.name)}},directives:[k.a,w.a,I.a,y.b,R.a,i.l,A.a,G.a,J.r,J.m,J.n,Q.c,K.b,Q.a,K.c,K.a,q.b,J.c,J.q,J.l,J.o,H.b,h.f,M.c,M.d,h.b,h.c,h.e,W.d],styles:["nz-tree[_ngcontent-%COMP%]{overflow:hidden}.custom-node[_ngcontent-%COMP%]{cursor:pointer;line-height:24px;margin-left:4px;display:inline-block}[_nghost-%COMP%]     .ant-tree .ant-tree-node-content-wrapper{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}[_nghost-%COMP%]     .ant-tree .ant-tree-node-content-wrapper :hover{background:#87ceff}.file-name[_ngcontent-%COMP%], .folder-name[_ngcontent-%COMP%]{margin-left:4px;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow:hidden;white-space:nowrap;-o-text-overflow:ellipsis;text-overflow:ellipsis;width:20px}.file-desc[_ngcontent-%COMP%], .folder-desc[_ngcontent-%COMP%]{padding:0 8px;display:inline-block;background:#87ceff;color:#fff;position:relative;left:12px}.custom-node-icon[_ngcontent-%COMP%]{width:20px;margin-right:8px}[_nghost-%COMP%]     .ant-btn-background-ghost.ant-btn-link{color:#000}[_nghost-%COMP%]     .ant-btn-background-ghost.ant-btn-link:hover{color:#fff}[_nghost-%COMP%]     .ant-btn-background-ghost.ant-btn-link:active{color:#fff}[_nghost-%COMP%]     .ant-tree .ant-tree-treenode{-webkit-box-align:center;-ms-flex-align:center;align-items:center}"]}),e})();var re=n("kmnG"),ce=n("qFsG"),de=n("bTqV");const ae=["treeNode"],le=["doneList"],ue=["buttonEvent"];function be(e,t){1&e&&u.Ub(0,"nz-empty",25),2&e&&u.sc("nzNotFoundContent","\u6682\u65e0\u6570\u636e")}function he(e,t){if(1&e){const e=u.ac();u.Zb(0,"div",26,27),u.hc("contextmenu",(function(n){u.Cc(e);const i=t.$implicit,o=u.Ac(3);return u.kc().contextMenu(n,o,i)}))("cdkDragStarted",(function(){u.Cc(e);const n=t.$implicit,i=t.index,o=u.Ac(1);return u.kc().dragStarted(n,i,o)})),u.Zb(2,"nz-dropdown-menu",null,28),u.Zb(4,"ul",5),u.Zb(5,"li",29),u.hc("click",(function(){u.Cc(e);const n=t.$implicit;return u.kc().cut(n)})),u.Lc(6," \u526a\u5207 "),u.Yb(),u.Yb(),u.Yb(),u.Zb(7,"div",30),u.Zb(8,"span",31),u.Lc(9),u.Yb(),u.Zb(10,"a",8),u.hc("click",(function(){u.Cc(e);const n=t.$implicit;return u.kc().startEdit(n.id)})),u.Ub(11,"i",32),u.Yb(),u.Zb(12,"a",8),u.hc("click",(function(){u.Cc(e);const n=t.$implicit;return u.kc().delItem(n)})),u.Ub(13,"i",33),u.Yb(),u.Yb(),u.Zb(14,"input",34),u.hc("ngModelChange",(function(n){return u.Cc(e),t.$implicit.content=n}))("blur",(function(){u.Cc(e);const n=t.$implicit;return u.kc().stopEdit(n)})),u.Yb(),u.Yb()}if(2&e){const e=t.$implicit,n=u.kc();u.Jb("box-active",e.active),u.sc("cdkDragData",e),u.Db(7),u.sc("hidden",n.editId===e.id),u.Db(2),u.Mc(e.content),u.Db(5),u.sc("hidden",n.editId!==e.id)("ngModel",e.content)}}const pe=[{path:"note",component:(()=>{class e{constructor(e,t,n,i,o,s){this.msgService=e,this.noteService=t,this.loginService=n,this.note2Service=i,this.route=o,this.nzContextMenuService=s,this.keyEnter=Object(r.a)(window,"keyup.enter"),this.submitSubject=new c.a,this.destroy$=new c.a,this.user=new l.c,this.isSpinning=!1,this.fieldContent="",this.editId=null,this.size="small",this.activatedId=null,this.done=[]}drop(e){e.previousContainer===e.container&&(Object(s.d)(e.container.data,e.previousIndex,e.currentIndex),this.updateItemSort())}ngOnInit(){this.onTreeDragEnd(),this.getUser()}dragStarted(e,t,n){this.noteService.dragSubject.next({item:e,index:t})}onTreeDragEnd(){this.note2Service.transTreeDragEnd.pipe(Object(d.a)(this.destroy$)).subscribe(e=>{this.addItemToOther(e.addKey,e.delKey.item.content),this.delItem(e.delKey.item)},e=>{console.log(e)})}startEdit(e){this.editId=e}stopEdit(e){this.editId=null,this.editItem(e)}editItem(e){this.noteService.editItem({itemid:e.id,content:e.content}).subscribe(e=>{this.getItems()})}getMenuList(e){this.treeNode.isSpinning=!0,this.noteService.getMenus().subscribe(t=>{this.treeNode.isSpinning=!1,this.treeNode.nodes=t.data,this.treeNode.activatedNode&&e===this.treeNode.activatedNode.key&&this.clearList()})}clearList(){this.done=[]}getUser(){this.noteService.getUser().subscribe(e=>{401===e.code?localStorage.getItem("uuid")||this.getUuid():(this.user=e,this.getMenuList())})}getUuid(){this.noteService.getUuid().subscribe(e=>{this.noteService.uuidSubject.next(e.data.uuid),localStorage.setItem("uuid",e.data.uuid),this.getMenuList()})}logout(){this.route.navigateByUrl("login"),localStorage.removeItem("uuid"),sessionStorage.removeItem("token")}activatedNodeChange(e){const t=this.treeNode.activatedNode.key;this.activatedId!==t&&(this.activatedId=t,this.getItems())}submit(){this.treeNode.activatedNode?this.submitSubject.next(this.fieldContent):this.msgService.warning("\u8bf7\u9009\u62e9\u4e00\u4e2a\u6587\u4ef6\u5939")}addItem(e){this.noteService.addItem({mid:this.treeNode.activatedNode.key,content:e}).subscribe(e=>{this.msgService.success("\u6dfb\u52a0\u6210\u529f"),this.getItems()})}addItemToOther(e,t){this.noteService.addItem({mid:e,content:t}).subscribe(e=>{this.msgService.success("\u79fb\u52a8\u6210\u529f")})}getItems(){const e=this.treeNode.activatedNode.key;this.isSpinning=!0,this.noteService.getItems({mid:e}).subscribe(e=>{this.isSpinning=!1,this.done=e.data.items})}delItem(e){this.isSpinning=!0,this.noteService.delItem(e.id).subscribe(e=>{this.getItems()})}updateItemSort(){const e=this.done.map(e=>e.id);this.noteService.updateItemSort({mid:this.done[0].mid,item_id_arr:e}).subscribe(e=>{this.getItems()})}contextMenu(e,t,n){this.done.map(e=>e.active=!1),n.active=!0,this.nzContextMenuService.create(e,t)}copy(e){this.activeItem=e,this.treeNode.activeItemId=e.id,this.setMoveItem()}cut(e){this.activeItem=e,this.activeItem=e,this.treeNode.activeItemId=e.id,this.setMoveItem()}setMoveItem(){this.treeNode.moveItem.is_catalog=2,this.treeNode.moveItem.drag_file="false"}ngAfterViewInit(){this.submitSubject.pipe(Object(a.a)(500),Object(d.a)(this.destroy$)).subscribe(e=>{this.noteService.addItem({mid:this.treeNode.activatedNode.key,content:e}).subscribe(e=>{this.msgService.success("\u6dfb\u52a0\u6210\u529f"),this.fieldContent="",this.getItems()})})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(t){return new(t||e)(u.Tb(b.e),u.Tb(p.a),u.Tb(m.a),u.Tb(z),u.Tb(o.d),u.Tb(h.a))},e.\u0275cmp=u.Nb({type:e,selectors:[["app-note"]],viewQuery:function(e,t){var n;1&e&&(u.Qc(ae,!0),u.Hc(le,!0),u.Hc(ue,!0)),2&e&&(u.zc(n=u.ic())&&(t.treeNode=n.first),u.zc(n=u.ic())&&(t.doneList=n.first),u.zc(n=u.ic())&&(t.buttonEvent=n.first))},decls:37,vars:9,consts:[[2,"height","100%"],[2,"background-color","#fff"],["nz-button","","nz-dropdown","","nzPlacement","bottomLeft",3,"nzDropdownMenu"],["nz-icon","","nzType","user"],["menu2","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",2,"width","80px"],["nz-menu-item","",2,"width","80px",3,"click"],["nz-button","","nzType","link","nzGhost","",1,"custom-node-icon",3,"click"],["nz-button","","nzType","link","nzGhost","",1,"custom-node-icon",2,"padding-left","0px",3,"click"],["nzWidth","35%",2,"padding-left","24px","margin-bottom","16px","overflow","hidden"],[2,"overflow","scroll","height","calc(100% + 20px)","width","100%","position","relative","right","-20px"],[3,"clearList","activatedNodeEmit","menuList","nodeList"],["treeNode",""],["nzWidth","65%",2,"overflow","hidden"],[1,"example-container","flex",2,"justify-content","space-between","flex-direction","column","height","100%","display","flex","padding","0 24px"],[2,"flex-grow","1","overflow-y","scroll",3,"nzSpinning"],["style","margin-top: 98px;",3,"nzNotFoundContent",4,"ngIf"],["cdkDropList","",2,"margin","16px 0",3,"cdkDropListData","cdkDropListDropped"],["doneList","cdkDropList"],["class","example-box","cdkDrag","",3,"box-active","cdkDragData","contextmenu","cdkDragStarted",4,"ngFor","ngForOf"],[2,"height","60px","margin","12px 0"],[2,"width","100%"],["matInput","",3,"ngModel","keyup.enter","ngModelChange"],["mat-button","","matSuffix","",2,"margin-bottom","6px",3,"click"],[2,"margin-top","98px",3,"nzNotFoundContent"],["cdkDrag","",1,"example-box",3,"cdkDragData","contextmenu","cdkDragStarted"],["dragEl",""],["menu","nzDropdownMenu"],["nz-menu-item","",1,"dropdownMenu",3,"click"],[2,"display","flex","justify-content","space-between","align-items","center",3,"hidden"],[2,"flex-grow","1"],["nz-icon","","nzType","edit","nzTheme","outline"],["nz-icon","","nzType","delete","nzTheme","outline"],["type","text","nz-input","",3,"hidden","ngModel","ngModelChange","blur"]],template:function(e,t){if(1&e&&(u.Zb(0,"nz-layout",0),u.Zb(1,"nz-header",1),u.Zb(2,"nz-button-group"),u.Zb(3,"button",2),u.Ub(4,"i",3),u.Yb(),u.Yb(),u.Zb(5,"nz-dropdown-menu",null,4),u.Zb(7,"ul",5),u.Zb(8,"li",6),u.Lc(9),u.Yb(),u.Zb(10,"li",7),u.hc("click",(function(){return t.logout()})),u.Lc(11,"\u9000\u51fa"),u.Yb(),u.Yb(),u.Yb(),u.Zb(12,"a",8),u.hc("click",(function(){return!t.user.username&&t.logout()})),u.Lc(13),u.Yb(),u.Zb(14,"a",9),u.hc("click",(function(){return t.logout()})),u.Lc(15),u.Yb(),u.Zb(16,"span"),u.Lc(17," \u7f51\u7edc\u8bb0\u4e8b\u672c "),u.Yb(),u.Yb(),u.Zb(18,"nz-layout",1),u.Zb(19,"nz-sider",10),u.Zb(20,"div",11),u.Zb(21,"app-note2",12,13),u.hc("clearList",(function(){return t.clearList()}))("activatedNodeEmit",(function(e){return t.activatedNodeChange(e)}))("menuList",(function(e){return t.getMenuList(e)}))("nodeList",(function(){return t.getItems()})),u.Yb(),u.Yb(),u.Yb(),u.Zb(23,"nz-content",14),u.Zb(24,"div",15),u.Zb(25,"nz-spin",16),u.Jc(26,be,1,1,"nz-empty",17),u.Zb(27,"div",18,19),u.hc("cdkDropListDropped",(function(e){return t.drop(e)})),u.Jc(29,he,15,7,"div",20),u.Yb(),u.Yb(),u.Zb(30,"div",21),u.Zb(31,"mat-form-field",22),u.Zb(32,"mat-label"),u.Lc(33,"\u8f93\u5165"),u.Yb(),u.Zb(34,"input",23),u.hc("keyup.enter",(function(){return t.submit()}))("ngModelChange",(function(e){return t.fieldContent=e})),u.Yb(),u.Zb(35,"button",24),u.hc("click",(function(){return t.submit()})),u.Lc(36," \u786e\u5b9a "),u.Yb(),u.Yb(),u.Yb(),u.Yb(),u.Yb(),u.Yb(),u.Yb()),2&e){const e=u.Ac(6);u.Db(3),u.sc("nzDropdownMenu",e),u.Db(6),u.Nc(" ",t.user.username?t.user.username:"\u6e38\u5ba2"," "),u.Db(4),u.Nc(" ",t.user.username?t.user.username:"Sign Up"," "),u.Db(2),u.Nc(" ",t.user.username?"Log Out":"Log In"," "),u.Db(10),u.sc("nzSpinning",t.isSpinning),u.Db(1),u.sc("ngIf",!t.done.length),u.Db(1),u.sc("cdkDropListData",t.done),u.Db(2),u.sc("ngForOf",t.done),u.Db(5),u.sc("ngModel",t.fieldContent)}},directives:[x.c,x.b,k.b,I.a,k.a,w.a,h.e,h.c,y.b,h.f,M.c,M.d,x.e,se,x.a,R.a,i.l,s.b,i.k,re.b,re.e,ce.a,J.c,J.l,J.o,de.a,re.f,H.b,s.a,q.b],styles:["nz-header[_ngcontent-%COMP%]{border-bottom:1px solid #f0f0f0}nz-content[_ngcontent-%COMP%], nz-sider[_ngcontent-%COMP%]{background-color:#fff}nz-content[_ngcontent-%COMP%]{border-left:1px solid #f0f0f0}nz-layout[_ngcontent-%COMP%]:last-child{margin:0}.example-container[_ngcontent-%COMP%]{width:100%;display:inline-block;vertical-align:top}.example-list[_ngcontent-%COMP%]{border:1px solid #ccc;min-height:60px;background:#fff;border-radius:4px;overflow:hidden;display:block}.flex[_ngcontent-%COMP%]{display:-webkit-box;display:-ms-flexbox;display:flex}.hidden[_ngcontent-%COMP%]{height:0!important;overflow:hidden}.box-active[_ngcontent-%COMP%]{background-color:#1890ff!important;opacity:.6}.example-box[_ngcontent-%COMP%]{color:rgba(0,0,0,.87);-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-sizing:border-box;box-sizing:border-box;cursor:move;background:#fff;font-size:14px;height:40px;line-height:40px;padding:0 8px}.example-box[_ngcontent-%COMP%]:hover{background-color:#1890ff}.dropdownMenu[_ngcontent-%COMP%]:hover{background-color:#1890ff!important;opacity:.8}.cdk-drag-preview[_ngcontent-%COMP%]{-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:4px;-webkit-box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);-o-transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.example-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .example-box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);transition:-webkit-transform .25s cubic-bezier(0,0,.2,1);-o-transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1);transition:transform .25s cubic-bezier(0,0,.2,1),-webkit-transform .25s cubic-bezier(0,0,.2,1)}  .ant-btn-background-ghost.ant-btn-link{color:rgba(0,0,0,.65)}"]}),e})()},{path:"note2",component:se},{path:"",redirectTo:"note",pathMatch:"full"}];let me=(()=>{class e{}return e.\u0275mod=u.Rb({type:e}),e.\u0275inj=u.Qb({factory:function(t){return new(t||e)},imports:[[o.g.forChild(pe)],o.g]}),e})();var ge=n("zMeI"),fe=(n("0EQZ"),n("7+OI"),n("2Vo4"),n("8LU1"),n("u47x"));n("cH1L");let ve=(()=>{class e{constructor(e){this.template=e}}return e.\u0275fac=function(t){return new(t||e)(u.Tb(u.M))},e.\u0275dir=u.Ob({type:e,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:["cdkTreeNodeDefWhen","when"]}}),e})(),ze=(()=>{class e{}return e.\u0275mod=u.Rb({type:e}),e.\u0275inj=u.Qb({factory:function(t){return new(t||e)},providers:[fe.e,ve]}),e})();var xe=n("FKr1");n("VRyK"),n("lJxs");let ke=(()=>{class e{}return e.\u0275mod=u.Rb({type:e}),e.\u0275inj=u.Qb({factory:function(t){return new(t||e)},imports:[[ze,xe.e],xe.e]}),e})();n.d(t,"HomeModule",(function(){return Ie}));let Ie=(()=>{class e{}return e.\u0275mod=u.Rb({type:e}),e.\u0275inj=u.Qb({factory:function(t){return new(t||e)},imports:[[i.c,me,x.d,s.c,ke,ge.a]]}),e})()}}]);